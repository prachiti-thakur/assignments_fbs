Assignment 5
1) List all the books that are written by Author Loni and has price 
less then 600.
mysql> select * from book where author_name="loni" and cost<600;
+---------+---------------------+-------------+--------+-----------+
| book_no | book_name           | author_name | cost   | category  |
+---------+---------------------+-------------+--------+-----------+
|     102 | oracle complete ref | loni        | 550.00 | databases |
|     103 | Mastering SQl       | loni        | 550.00 | databases |
+---------+---------------------+-------------+--------+-----------+
2) List the Issue details for the books that are not returned yet.
mysql> select * from issue;
+--------------+---------+-----------+------------+-------------+
| lib_issue_id | book_no | member_id | issue_date | return_date |
+--------------+---------+-----------+------------+-------------+
|         7001 |     101 |         1 | 2006-12-10 | 2006-12-25  |
|         7002 |     102 |         2 | 2006-12-25 | 2007-01-09  |
|         7005 |     104 |         2 | 2006-11-06 | 2006-11-21  |
|         7006 |     101 |         3 | 2006-02-18 | 2006-03-05  |
+--------------+---------+-----------+------------+-------------+
4 rows in set (0.02 sec)

mysql> select * from issue where return_date is NULL;

3) Update all the blank return_date with 31-Dec-06 excluding 7005 
and 7006.

mysql> select * from issue;
+--------------+---------+-----------+------------+-------------+
| lib_issue_id | book_no | member_id | issue_date | return_date |
+--------------+---------+-----------+------------+-------------+
|         7001 |     101 |         1 | 2006-12-10 | 2006-12-25  |
|         7002 |     102 |         2 | 2006-12-25 | 2007-01-09  |
|         7005 |     104 |         2 | 2006-11-06 | 2006-11-21  |
|         7006 |     101 |         3 | 2006-02-18 | 2006-03-05  |
+--------------+---------+-----------+------------+-------------+
4 rows in set (0.00 sec)

mysql> update issue set return_date="2006-12-30" where return_date is null a
nd lib_issue_id not in(7005,7006);

4) List all the Issue details that have books issued for more then 30 
days.
mysql> select * from issue where return_date is null and datediff(curdate(),issue_date)>30;
+--------------+---------+-----------+------------+-------------+
| lib_issue_id | book_no | member_id | issue_date | return_date |
+--------------+---------+-----------+------------+-------------+
|         7009 |     105 |         4 | 2023-12-30 | NULL        |
+--------------+---------+-----------+------------+-------------+
mysql> select * from issue where datediff(return_date,issue_date)>30;
+--------------+---------+-----------+------------+-------------+
| lib_issue_id | book_no | member_id | issue_date | return_date |
+--------------+---------+-----------+------------+-------------+
|         7004 |     104 |         3 | 2006-07-13 | 2006-08-30  |
+--------------+---------+-----------+------------+-------------+
1 row in set (0.00 sec)

mysql> select * from issue where lib_issue_id=(select lib_issue_id from (select * from issue where datediff(return_date,issue_date)>30) i) or lib_issue_id=(select lib_issue_id from (select * from issue where return_date is null and datediff
(curdate(),issue_date)>30) j);
+--------------+---------+-----------+------------+-------------+
| lib_issue_id | book_no | member_id | issue_date | return_date |
+--------------+---------+-----------+------------+-------------+
|         7004 |     104 |         3 | 2006-07-13 | 2006-08-30  |
|         7009 |     105 |         4 | 2023-12-30 | NULL        |
+--------------+---------+-----------+------------+-------------+


5) List all the books that have price in range of 500 to 750 and has 
category as Database.
mysql> select * from book where cost between 500 and 700  and category ="dat
abases";
+---------+---------------------+-------------+--------+-----------+
| book_no | book_name           | author_name | cost   | category  |
+---------+---------------------+-------------+--------+-----------+
|     102 | oracle complete ref | loni        | 550.00 | databases |
|     103 | Mastering SQl       | loni        | 550.00 | databases |
+---------+---------------------+-------------+--------+-----------+

6) List all the books that belong to any one of the following 
categories Science, Database, Fiction, Management.
mysql> select * from book where category in("science","Databases","Fiction",
"management");
+---------+---------------------+-------------+--------+-----------+
| book_no | book_name           | author_name | cost   | category  |
+---------+---------------------+-------------+--------+-----------+
|     102 | oracle complete ref | loni        | 550.00 | databases |
|     103 | Mastering SQl       | loni        | 550.00 | databases |
|     104 | Pl-Sql              | scott urman | 750.00 | databases |
+---------+---------------------+-------------+--------+-----------+

7) List all the members in the descending order of Penalty due on 
them.
mysql> select * from member order by penalty_amount;
+-----------+-----------------+----------------+---------------+-----------------+-----------+------------------+----------------+
| member_id | member_name     | member_address | acc_open_date | membership_type | fees_paid | max_book_allowed | penalty_amount |
+-----------+-----------------+----------------+---------------+-----------------+-----------+------------------+----------------+
|         2 | garima sen      | pune           | 2024-06-07    | Annul           |      1000 |                3 |           NULL |
|         3 | prachiti thakur | Pune           | 2004-06-04    | quarterly       |      8000 |                4 |           NULL |
|         7 | mihir joshi     | mumbai         | 2022-11-01    | quarterly       |      3400 |                3 |          20.00 |
|         6 | akash patil     | banglore       | 2023-12-01    | lifetime        |      4000 |                3 |          30.00 |
|         8 | pragati saste   | satara         | 2002-03-04    | lifetime        |       900 |                1 |          30.00 |
|         5 | pari thakur     | Nagpur         | 2006-06-01    | half yearly     |      6700 |                6 |          40.00 |
|         1 | Richa sharma    | pune           | 2005-12-10    | lifetime        |     25000 |                5 |          50.00 |
|         4 | shreya zinzade  | Mumbai         | 2005-04-06    | half yearly     |      5000 |                6 |          60.00 |
+-----------+-----------------+----------------+---------------+-----------------+-----------+------------------+----------------+


8) Modify the price of book with id 103 to Rs 300 and category to 
RDBMS.

mysql> update book set cost=300 where book_no=103 and category="RDBMS";
Query OK, 0 rows affected (0.00 sec)
Rows matched: 0  Changed: 0  Warnings: 0

9) List all the books in ascending order of category and descending 
order of price

mysql> select * from book order by category,cost desc;
+---------+---------------------+---------------+--------+-----------+
| book_no | book_name           | author_name   | cost   | category  |
+---------+---------------------+---------------+--------+-----------+
|     107 | OOp                 | graddy bouch  | 890.00 | system    |
|     106 | c++                 | balgurusami   | 560.00 | system    |
|     101 | Lets us c           | Denis Ritchie | 450.00 | system    |
|     104 | Pl-Sql              | scott urman   | 750.00 | databases |
|     102 | oracle complete ref | loni          | 550.00 | databases |
|     103 | Mastering SQl       | loni          | 550.00 | databases |
|     105 | national geographic | adis scott    | 100.00 | others    |
+---------+---------------------+---------------+--------+-----------+

9) List all the books in ascending order of category and descending 
order of price

mysql> select * from book order by category,cost desc;
+---------+---------------------+---------------+--------+-----------+
| book_no | book_name           | author_name   | cost   | category  |
+---------+---------------------+---------------+--------+-----------+
|     107 | OOp                 | graddy bouch  | 890.00 | system    |
|     106 | c++                 | balgurusami   | 560.00 | system    |
|     101 | Lets us c           | Denis Ritchie | 450.00 | system    |
|     104 | Pl-Sql              | scott urman   | 750.00 | databases |
|     102 | oracle complete ref | loni          | 550.00 | databases |
|     103 | Mastering SQl       | loni          | 550.00 | databases |
|     105 | national geographic | adis scott    | 100.00 | others    |
+---------+---------------------+---------------+--------+-----------+

10) List all the books that contain word SQL in the name of the book


mysql> select book_name from book where book_name like "%sql%";
+---------------+
| book_name     |
+---------------+
| Mastering SQl |
| Pl-Sql        |
+---------------+

11) List the Lib_Issue_Id, Issue_Date, Return_Date and No of days 
Book was issued

mysql> select lib_issue_id,issue_date,return_date,datediff(return_date,issue_date) no_of_days from issue;
+--------------+------------+-------------+------------+
| lib_issue_id | issue_date | return_date | no_of_days |
+--------------+------------+-------------+------------+
|         7001 | 2006-12-10 | 2006-12-25  |         15 |
|         7002 | 2006-12-25 | 2007-01-09  |         15 |
|         7005 | 2006-11-06 | 2006-11-21  |         15 |
|         7006 | 2006-02-18 | 2006-03-05  |         15 |
+--------------+------------+-------------+------------+
12) Find the details of the member of the Library in the order of their 
joining the library.
mysql> select * from issue order by issue_date;
+--------------+---------+-----------+------------+-------------+
| lib_issue_id | book_no | member_id | issue_date | return_date |
+--------------+---------+-----------+------------+-------------+
|         7006 |     101 |         3 | 2006-02-18 | 2006-03-05  |
|         7005 |     104 |         2 | 2006-11-06 | 2006-11-21  |
|         7001 |     101 |         1 | 2006-12-10 | 2006-12-25  |
|         7002 |     102 |         2 | 2006-12-25 | 2007-01-09  |

13) Display the count of total no of books issued to Member 101.
mysql> select count(*) from issue group by member_id having member_id=1;
+----------+
| count(*) |
+----------+
|        1 |
+----------+
14) Display the total penalty due for all the members.
mysql> select sum(penalty_amount) from member;
+---------------------+
| sum(penalty_amount) |
+---------------------+
|              230.00 |
+---------------------+

15) Display the total no of members
mysql> select count(*) from member;
+----------+
| count(*) |
+----------+
|        8 |
+----------+
16) Display the total no of books issued 

mysql> select count(*) from issue;
+----------+
| count(*) |
+----------+
|        4 |
+----------+

17) Display the average membership fees paid by all the members
mysql> select avg(fees_paid) from member;
+----------------+
| avg(fees_paid) |
+----------------+
|      6750.0000 |
+----------------+
18) List the various categories and count of books in each category

mysql> select * from book;
+---------+---------------------+---------------+--------+-----------+
| book_no | book_name           | author_name   | cost   | category  |
+---------+---------------------+---------------+--------+-----------+
|     101 | Lets us c           | Denis Ritchie | 100.00 | system    |
|     102 | oracle complete ref | loni          | 550.00 | databases |
|     103 | Mastering SQl       | loni          | 550.00 | databases |
|     104 | Pl-Sql              | scott urman   | 750.00 | databases |
|     105 | national geographic | adis scott    | 100.00 | others    |
|     106 | c++                 | balgurusami   | 560.00 | system    |
|     107 | OOp                 | graddy bouch  | 890.00 | system    |
+---------+---------------------+---------------+--------+-----------+
7 rows in set (0.00 sec)

mysql> select category,count(*) from book group by category;
+-----------+----------+
| category  | count(*) |
+-----------+----------+
| system    |        3 |
| databases |        3 |
| others    |        1 |
+-----------+----------+

19) List the book_No and the number of times the book is issued in the 
descending order of count.

mysql> select book_no,count(*) from issue group by book_no order by count(*) desc;
+---------+----------+
| book_no | count(*) |
+---------+----------+
|     101 |        2 |
|     102 |        1 |
|     104 |        1 |
+---------+----------+


20) Find the maximum, minimum, total and average penalty amount in 
the member table.

mysql> select min(penalty_amount),max(penalty_amount),sum(penalty_amount),av
g(penalty_amount) from member;
+---------------------+---------------------+---------------------+---------------------+
| min(penalty_amount) | max(penalty_amount) | sum(penalty_amount) | avg(penalty_amount) |
+---------------------+---------------------+---------------------+---------------------+
|               20.00 |               60.00 |              230.00 |
  38.333333 |
+---------------------+---------------------+---------------------+---------------------+

21) Display the member id and the no of books for each member that 
has issued more then 2 books.

mysql> select member_id,count(*) from issue group by member_id having count(*)>2;
+-----------+----------+
| member_id | count(*) |
+-----------+----------+
|         2 |        3 |
+-----------+----------+

22) Display the member id, book no and no of times the same book is 
issued by the member in the descending order of count.

mysql> select member_id,book_no,count(*) from issue group by member_id,book_no;
+-----------+---------+----------+
| member_id | book_no | count(*) |
+-----------+---------+----------+
|         1 |     101 |        1 |
|         2 |     102 |        1 |
|         2 |     101 |        1 |
|         3 |     104 |        1 |
|         2 |     104 |        1 |
|         3 |     101 |        1 |
|         5 |     107 |        1 |
|         7 |     105 |        1 |
|         4 |     105 |        1 |
|         6 |     102 |        1 |
|         8 |     103 |        1 |
+-----------+---------+----------+
11 rows in set (0.00 sec)


24) List the book_no of all the books that are not issued to any 
member so far.
mysql> select book_no,book_name from book where book_no not in(select book_n
o from issue);
+---------+---------------------+
| book_no | book_name           |
+---------+---------------------+
|     103 | Mastering SQl       |
|     105 | national geographic |
|     106 | c++                 |
|     107 | OOp                 |
+---------+---------------------+

25) List all the member id that exist in member table and has also at 
least one book issued by them. 

mysql> select distinct(member_id) from issue;
+-----------+
| member_id |
+-----------+
|         1 |
|         2 |
|         3 |
+-----------+

26) List the member ID with highest and lowest no of books issued.
mysql> (select member_id, count(*) from issue group by member_id order by count(*) desc limit 1)
    -> union
    -> (select member_id ,count(*) from issue group by member_id order by count(*)  limit 1);
+-----------+----------+
| member_id | count(*) |
+-----------+----------+
|         2 |        3 |
|         1 |        1 |
+-----------+----------+

27) List all the Issue_details for books issued in December and July 
without using any arithmetic, Logical or comparison operator.

mysql> select * from issue where month(issue_date) in(7,12);
+--------------+---------+-----------+------------+-------------+
| lib_issue_id | book_no | member_id | issue_date | return_date |
+--------------+---------+-----------+------------+-------------+
|         7001 |     101 |         1 | 2006-12-10 | 2006-12-25  |
|         7002 |     102 |         2 | 2006-12-25 | 2007-01-09  |
|         7003 |     101 |         2 | 2006-12-15 | 2006-11-07  |
|         7004 |     104 |         3 | 2006-07-13 | 2006-08-30  |
+--------------+---------+-----------+------------+-------------+
28) List the Book_No, Book_Name and Issue_date for all the books 
that are issued in month of December and belong to category Database.

mysql> select book_name,i.book_no ,issue_date from issue i inner join book j on i.book_no=j.book_no where category='databases' and month(issue_date)=12;
+---------------------+---------+------------+
| book_name           | book_no | issue_date |
+---------------------+---------+------------+
| oracle complete ref |     102 | 2006-12-25 |
+---------------------+---------+------------+

29) List the Member Id, Member Name and max books allowed in the 
descending order of the max books allowed.
mysql> select member_id,member_name,max_book_allowed from member order by max_book_allowed desc;
+-----------+-----------------+------------------+
| member_id | member_name     | max_book_allowed |
+-----------+-----------------+------------------+
|         4 | shreya zinzade  |                6 |
|         5 | pari thakur     |                6 |
|         1 | Richa sharma    |                5 |
|         3 | prachiti thakur |                4 |
|         2 | garima sen      |                3 |
|         6 | akash patil     |                3 |
|         7 | mihir joshi     |                3 |
|         8 | pragati saste   |                1 |
+-----------+-----------------+------------------+

30) List the Book No, Book Name, Issue_date and Return_Date for all 
the books issued by Richa Sharma.

mysql> select b.book_no,book_name,issue_date,return_date from book b inner join issue i
    -> on b.book_no=i.book_no
    -> where b.book_no in (select book_no from issue where member_id=(select member_id from member where member_name="Richa sharma")) and member_id =( select member_id from member where member_name="Richa sharma");
+---------+-----------+------------+-------------+
| book_no | book_name | issue_date | return_date |
+---------+-----------+------------+-------------+
|     101 | Lets us c | 2006-12-10 | 2006-12-25  |
+---------+-----------+------------+-------------+

31) List the details of all the members that have issued books in 
Database category.

mysql> select * from member where member_id in(select member_id from issue where book_no in(select book_no from book where category ="databases"));
+-----------+-----------------+----------------+---------------+-----------------+-----------+------------------+----------------+
| member_id | member_name     | member_address | acc_open_date | membership_type | fees_paid | max_book_allowed | penalty_amount |
+-----------+-----------------+----------------+---------------+-----------------+-----------+------------------+----------------+
|         2 | garima sen      | pune           | 2024-06-07    | Annul           |      1000 |                3 |           NULL |
|         3 | prachiti thakur | Pune           | 2004-06-04    | quarterly       |      8000 |                4 |           NULL |
+-----------+-----------------+----------------+---------------+-----------------+-----------+------------------+----------------+

32) List all the books that have highest price in their own category.
33) List all the Issue_Details where Issue_date is not within the 
Acc_open_date and Return_date for that member
mysql> select * from issue;
+--------------+---------+-----------+------------+-------------+
| lib_issue_id | book_no | member_id | issue_date | return_date |
+--------------+---------+-----------+------------+-------------+
|         7001 |     101 |         1 | 2006-12-10 | 2006-12-25  |
|         7002 |     102 |         2 | 2006-12-25 | 2007-01-09  |
|         7003 |     101 |         2 | 2006-12-15 | 2006-11-07  |
|         7004 |     104 |         3 | 2006-07-13 | 2006-08-30  |
|         7005 |     104 |         2 | 2006-11-06 | 2006-11-21  |
|         7006 |     101 |         3 | 2006-02-18 | 2006-03-05  |
|         7007 |     107 |         5 | 2006-10-10 | 2006-10-10  |
|         7008 |     105 |         7 | 2004-06-04 | 2004-06-04  |
+--------------+---------+-----------+------------+-------------+
8 rows in set (0.00 sec)

mysql> select * from issue where issue_date not in(select acc_open_date from member) and issue_date!=return_date;
+--------------+---------+-----------+------------+-------------+
| lib_issue_id | book_no | member_id | issue_date | return_date |
+--------------+---------+-----------+------------+-------------+
|         7001 |     101 |         1 | 2006-12-10 | 2006-12-25  |
|         7002 |     102 |         2 | 2006-12-25 | 2007-01-09  |
|         7003 |     101 |         2 | 2006-12-15 | 2006-11-07  |
|         7004 |     104 |         3 | 2006-07-13 | 2006-08-30  |
|         7005 |     104 |         2 | 2006-11-06 | 2006-11-21  |
|         7006 |     101 |         3 | 2006-02-18 | 2006-03-05  |
+--------------+---------+-----------+------------+-------------+


34) List all the members that have not issued a single book so far.

mysql> select member_id from member where member_id not in(select member_id from issue);
+-----------+
| member_id |
+-----------+
|         4 |
|         6 |
|         8 |
+-----------+
3 rows in set (0.00 sec)

mysql> select * from member where member_id not in(select member_id from issue);
+-----------+----------------+----------------+---------------+-----------------+-----------+------------------+----------------+
| member_id | member_name    | member_address | acc_open_date | membership_type | fees_paid | max_book_allowed | penalty_amount |
+-----------+----------------+----------------+---------------+-----------------+-----------+------------------+----------------+
|         4 | shreya zinzade | Mumbai         | 2005-04-06    | half yearly     |      5000 |                6 |          60.00 |
|         6 | akash patil    | banglore       | 2023-12-01    | lifetime        |      4000 |                3 |          30.00 |
|         8 | pragati saste  | satara         | 2002-03-04    | lifetime        |       900 |                1 |          30.00 |
+-----------+----------------+----------------+---------------+-----------------+-----------+------------------+----------------+

35) List all the members that have issued the same book as issued by 
Garima

mysql> select * from member where member_id in ( select member_id from issue
 where book_no in(select book_no from issue where member_id=(select member_i
d from member where member_name="Richa sharma")));
+-----------+-----------------+----------------+---------------+-----------------+-----------+------------------+----------------+
| member_id | member_name     | member_address | acc_open_date | membership_type | fees_paid | max_book_allowed | penalty_amount |
+-----------+-----------------+----------------+---------------+-----------------+-----------+------------------+----------------+
|         1 | Richa sharma    | pune           | 2005-12-10    | lifetime        |     25000 |                5 |          50.00 |
|         2 | garima sen      | pune           | 2024-06-07    | Annul           |      1000 |                3 |           NULL |
|         3 | prachiti thakur | Pune           | 2004-06-04    | quarterly       |      8000 |                4 |           NULL |
+-----------+-----------------+----------------+---------------+-----------------+-----------+------------------+----------------+

36) List the Book_Name, Price of all the books that are not returned 
for more then 30 days.


37) List all the authors and book_name that has more then 1 book 
written by them.
select author_name,book_name from book where author_name in( select author_name from book group by author_name having count(*)>=1);
+---------------+---------------------+
| author_name   | book_name           |
+---------------+---------------------+
| Denis Ritchie | Lets us c           |
| loni          | oracle complete ref |
| loni          | Mastering SQl       |
| scott urman   | Pl-Sql              |
| adis scott    | national geographic |
| balgurusami   | c++                 |
| graddy bouch  | OOp                 |
+---------------+---------------------+

38) List the Member ID, Member Name of the people that have issued 
the highest and the lowest no of books


39) List the details of highest 3 priced books.

mysql> select book_name,cost from book order by cost desc limit 3;
+-----------+--------+
| book_name | cost   |
+-----------+--------+
| OOp       | 890.00 |
| Pl-Sql    | 750.00 |
| c++       | 560.00 |
+-----------+--------+

40) List the total cost of all the books that are currently issued but not 
returned.
mysql> select book_no from issue where return_date is NULL;
+---------+
| book_no |
+---------+
|     105 |
|     102 |
+---------+
2 rows in set (0.00 sec)

mysql> select sum(cost) from book where book_no in (select book_no from issu
e where return_date is NULL);
+-----------+
| sum(cost) |
+-----------+
|    650.00 |
+-----------+
1 row in set (0.02 sec)

mysql> select * from book;
+---------+---------------------+---------------+--------+-----------+
| book_no | book_name           | author_name   | cost   | category  |
+---------+---------------------+---------------+--------+-----------+
|     101 | Lets us c           | Denis Ritchie | 100.00 | system    |
|     102 | oracle complete ref | loni          | 550.00 | databases |
|     103 | Mastering SQl       | loni          | 550.00 | databases |
|     104 | Pl-Sql              | scott urman   | 750.00 | databases |
|     105 | national geographic | adis scott    | 100.00 | others    |
|     106 | c++                 | balgurusami   | 560.00 | system    |
|     107 | OOp                 | graddy bouch  | 890.00 | system    |
+---------+---------------------+---------------+--------+-----------+

41) List the details of the book that has been issued maximum no of 
times

mysql> select * from book where book_no=(select book_no from issue group by
book_no order by count(*) desc limit 1);
+---------+-----------+---------------+--------+----------+
| book_no | book_name | author_name   | cost   | category |
+---------+-----------+---------------+--------+----------+
|     101 | Lets us c | Denis Ritchie | 100.00 | system   |
+---------+-----------+---------------+--------+----------+

42) List how many books are issued to lifetime members

mysql> select book_no from issue where member_id in(select member_id from member where membership_type="lifetime");
+---------+
| book_no |
+---------+
|     101 |
|     102 |
+---------+
2 rows in set (0.00 sec)

mysql> select count(*) from  (select book_no from issue where member_id in(s
elect member_id from member where membership_type="lifetime")) as i;
+----------+
| count(*) |
+----------+
|        2 |
+----------+

43) List all member types and how many members are there in each 
type.

mysql> select membership_type ,count(*) from member group by membership_type
;
+-----------------+----------+
| membership_type | count(*) |
+-----------------+----------+
| lifetime        |        3 |
| Annul           |        1 |
| quarterly       |        2 |
| half yearly     |        2 |

44) List first 5 members who had joined library

 45) List the members with their member type, who have issued books 
during the period 1st December to 31st December

ysql> select member_id,membership_type from member where member_id in(select member_id from issue where month(issue_date)=12);
+-----------+-----------------+
| member_id | membership_type |
+-----------+-----------------+
|         1 | lifetime        |
|         2 | Annul           |
|         4 | half yearly     |
+-----------+-----------------+

46,List all the members who have not returned books yet. 


47) List all the members who joined library on the same date Garima 
joined.

mysql> select * from member where acc_open_date in(select acc_open_date from
 member where member_name="garima sen");
+-----------+---------------+----------------+---------------+-----------------+-----------+------------------+----------------+
| member_id | member_name   | member_address | acc_open_date | membership_type | fees_paid | max_book_allowed | penalty_amount |
+-----------+---------------+----------------+---------------+-----------------+-----------+------------------+----------------+
|         2 | garima sen    | pune           | 2024-06-07    | Annul           |      1000 |                3 |           NULL |
|         9 | pravin thakur | Raigad         | 2024-06-07    | Annul           |      8900 |                5 |          70.00 |
+-----------+---------------+----------------+---------------+-----------------+-----------+------------------+----------------+

48) List all the members who has issued books from author “Loni” in 
the month of December
mysql> select * from member where member_id in(select member_id from issue w
here book_no in(select book_no from book where author_name="loni"));
+-----------+---------------+----------------+---------------+-----------------+-----------+------------------+----------------+
| member_id | member_name   | member_address | acc_open_date | membership_type | fees_paid | max_book_allowed | penalty_amount |
+-----------+---------------+----------------+---------------+-----------------+-----------+------------------+----------------+
|         2 | garima sen    | pune           | 2024-06-07    | Annul           |      1000 |                3 |           NULL |
|         6 | akash patil   | banglore       | 2023-12-01    | lifetime        |      4000 |                3 |          30.00 |
|         8 | pragati saste | satara         | 2002-03-04    | lifetime        |       900 |                1 |          30.00 |
+-----------+---------------+----------------+---------------+-----------------+-----------+------------------+----------------+

 49) List names of the authors whose books are least issued by 
lifetime members.

mysql> select * from issue inner join book inner join member on issue.book_no=book.book_no and issue.member_id=member.member_id;
+--------------+---------+-----------+------------+-------------+---------+---------------------+---------------+--------+-----------+-----------+-----------------+----------------+---------------+-----------------+-----------+------------------+----------------+
| lib_issue_id | book_no | member_id | issue_date | return_date | book_no | book_name           | author_name   | cost   | category  | member_id | member_name     | member_address | acc_open_date | membership_type | fees_paid | max_book_allowed | penalty_amount |
+--------------+---------+-----------+------------+-------------+---------+---------------------+---------------+--------+-----------+-----------+-----------------+----------------+---------------+-----------------+-----------+------------------+----------------+
|         7001 |     101 |         1 | 2006-12-10 | 2006-12-25  |     101 | Lets us c           | Denis Ritchie | 100.00 | system    |         1 | Richa sharma    | pune           | 2005-12-10    | lifetime        |     25000 |                5 |          50.00 |
|         7003 |     101 |         2 | 2006-12-15 | 2006-11-07  |     101 | Lets us c           | Denis Ritchie | 100.00 | system    |         2 | garima sen      | pune           | 2024-06-07    | Annul           |      1000 |                3 |         100.00 |
|         7006 |     101 |         3 | 2006-02-18 | 2006-03-05  |     101 | Lets us c           | Denis Ritchie | 100.00 | system    |         3 | prachiti thakur | Pune           | 2004-06-04    | quarterly       |      8000 |                4 |           NULL |
|         7002 |     102 |         2 | 2006-12-25 | 2007-01-09  |     102 | oracle complete ref | loni          | 550.00 | databases |         2 | garima sen      | pune           | 2024-06-07    | Annul           |      1000 |                3 |         100.00 |
|         7010 |     102 |         6 | 2024-10-05 | NULL        |     102 | oracle complete ref | loni          | 550.00 | databases |         6 | akash patil     | banglore       | 2023-12-01    | lifetime        |      4000 |                3 |          30.00 |
|         7011 |     103 |         8 | 2004-06-04 | 2004-07-01  |     103 | Mastering SQl       | loni          | 550.00 | databases |         8 | pragati saste   | satara         | 2002-03-04    | lifetime        |       900 |                1 |          30.00 |
|         7004 |     104 |         3 | 2006-07-13 | 2006-08-30  |     104 | Pl-Sql              | scott urman   | 750.00 | databases |         3 | prachiti thakur | Pune           | 2004-06-04    | quarterly       |      8000 |                4 |           NULL |
|         7005 |     104 |         2 | 2006-11-06 | 2006-11-21  |     104 | Pl-Sql              | scott urman   | 750.00 | databases |         2 | garima sen      | pune           | 2024-06-07    | Annul           |      1000 |                3 |         100.00 |
|         7008 |     105 |         7 | 2004-06-04 | 2004-06-04  |     105 | national geographic | adis scott    | 100.00 | others    |         7 | mihir joshi     | mumbai         | 2022-11-01    | quarterly       |      3400 |                3 |          20.00 |
|         7009 |     105 |         4 | 2023-12-30 | NULL        |     105 | national geographic | adis scott    | 100.00 | others    |         4 | shreya zinzade  | Mumbai         | 2005-04-06    | half yearly     |      5000 |                6 |          60.00 |
|         7007 |     107 |         5 | 2006-10-10 | 2006-10-10  |     107 | OOp                 | graddy bouch  | 890.00 | system    |         5 | pari thakur     | Nagpur         | 2006-06-01    | lifetime        |      6700 |                6 |          40.00 |
+--------------+---------+-----------+------------+-------------+---------+---------------------+---------------+--------+-----------+-----------+-----------------+----------------+---------------+-----------------+-----------+------------------+----------------+
11 rows in set (0.00 sec)

mysql> select author_name,count(*) from issue inner join book inner join member on issue.book_no=book.book_no and issue.member_id=member.member_id group by author_name;
+---------------+----------+
| author_name   | count(*) |
+---------------+----------+
| Denis Ritchie |        3 |
| loni          |        3 |
| scott urman   |        2 |
| adis scott    |        2 |
| graddy bouch  |        1 |
+---------------+----------+
5 rows in set (0.00 sec)

mysql> select author_name,count(*) from issue inner join book inner join member on issue.book_no=book.book_no and issue.member_id=member.member_id where membership_type='lifetime' group by author_name;
+---------------+----------+
| author_name   | count(*) |
+---------------+----------+
| Denis Ritchie |        1 |
| graddy bouch  |        1 |
| loni          |        2 |
+---------------+----------+
3 rows in set (0.00 sec)
       select author_name,count(*) from issue inner join book inner join member on issue.book_no=book.book_no and issue.member_id=member.member_id where membership_type='lifetime' group by author_name;
+---------------+----------+
| author_name   | count(*) |
+---------------+----------+
| Denis Ritchie |        1 |
| graddy bouch  |        1 |
| loni          |        2 |
+---------------+----------+
3 rows in set (0.00 sec)

mysql> select author_name,count(*) from issue inner join book inner join member on issue.book_no=book.book_no and issue.member_id=member.member_id where membership_type='lifetime' group by author_name order by count(*) limit 1;
+---------------+----------+
| author_name   | count(*) |
+---------------+----------+
| Denis Ritchie |        1 |
+---------------+----------+
1 row in set (0.00 sec)

mysql> select author_name,count(*) cst from issue inner join book inner join member on issue.book_no=book.book_no and issue.member_id=member.member_id where membership_type='lifetime' group by author_name order by cst limit 1;
+---------------+-----+
| author_name   | cst |
+---------------+-----+
| Denis Ritchie |   1 |
+---------------+-----+
1 row in set (0.00 sec)

mysql> select cst from ( select author_name,count(*) cst from issue inner join book inner join member on issue.book_no=book.book_no and issue.member_id=member.member_id where membership_type='lifetime' group by author_name order by cst limit 1) i;
+-----+
| cst |
+-----+
|   1 |
+-----+
1 row in set (0.00 sec)

mysql> select author_name,count(*) from issue inner join book inner join member on issue.book_no=book.book_no and issue.member_id=member.member_id where membership_type='lifetime' group by author_name;
+---------------+----------+
| author_name   | count(*) |
+---------------+----------+
| Denis Ritchie |        1 |
| graddy bouch  |        1 |
| loni          |        2 |
+---------------+----------+
mysql> select author_name from (select author_name,count(*) cst from issue inner join book inner join member on issue.book_no=book.book_no and issue.member_id=member.member_id where membership_type='lifetime' group by author_name) i wh
ere cst=(select cst from ( select author_name,count(*) cst from issue inner join book inner join member on issue.book_no=book.book_no and issue.member_id=member.member_id where membership_type='lifetime' group by author_name order by cst limit 1) i);
+---------------+
| author_name   |
+---------------+
| Denis Ritchie |
| graddy bouch  |
+---------------+
50) List the names of members who has issued the books whose cost 
is more than 300 rupees and whose author is “Scott Urman”


mysql> select * from member where member_id in( select member_id from issue where book_no in(select book_no from book where cost>300 and author_name="sc
ott urman"));
+-----------+-----------------+----------------+---------------+-----------------+-----------+------------------+----------------+
| member_id | member_name     | member_address | acc_open_date | membership_type | fees_paid | max_book_allowed | penalty_amount |
+-----------+-----------------+----------------+---------------+-----------------+-----------+------------------+----------------+
|         2 | garima sen      | pune           | 2024-06-07    | Annul           |      1000 |                3 |           NULL |
|         3 | prachiti thakur | Pune           | 2004-06-04    | quarterly       |      8000 |                4 |           NULL |
+-----------+-----------------+----------------+---------------+-----------------+-----------+------------------+----------------+

51) List all lifetime members who joined library during 1st January 
2006 to 31st December 2006 but issued only one book
mysql> select * from member where member_id in( select member_id from member
 where membership_type="lifetime" and year(acc_open_date)="2006");
+-----------+-------------+----------------+---------------+-----------------+-----------+------------------+----------------+
| member_id | member_name | member_address | acc_open_date | membership_type | fees_paid | max_book_allowed | penalty_amount |
+-----------+-------------+----------------+---------------+-----------------+-----------+------------------+----------------+
|         5 | pari thakur | Nagpur         | 2006-06-01    | lifetime        |      6700 |                6 |          40.00 |
+-----------+-------------+----------------+---------------+-----------------+-----------+------------------+----------------+

52) Modify the Penalty_Amount for Garima Sen to Rs 100.


mysql> update member set penalty_amount=100 where member_name="garima sen";
Query OK, 1 row affected (0.00 sec)
Rows matched: 1  Changed: 1  Warnings: 0

mysql> select * from member;
+-----------+-----------------+----------------+---------------+-----------------+-----------+------------------+----------------+
| member_id | member_name     | member_address | acc_open_date | membership_type | fees_paid | max_book_allowed | penalty_amount |
+-----------+-----------------+----------------+---------------+-----------------+-----------+------------------+----------------+
|         1 | Richa sharma    | pune           | 2005-12-10    | lifetime        |     25000 |                5 |          50.00 |
|         2 | garima sen      | pune           | 2024-06-07    | Annul           |      1000 |                3 |         100.00 |
|         3 | prachiti thakur | Pune           | 2004-06-04    | quarterly       |      8000 |                4 |           NULL |
|         4 | shreya zinzade  | Mumbai         | 2005-04-06    | half yearly     |      5000 |                6 |          60.00 |
|         5 | pari thakur     | Nagpur         | 2006-06-01    | lifetime        |      6700 |                6 |          40.00 |
|         6 | akash patil     | banglore       | 2023-12-01    | lifetime        |      4000 |                3 |          30.00 |
|         7 | mihir joshi     | mumbai         | 2022-11-01    | quarterly       |      3400 |                3 |          20.00 |
|         8 | pragati saste   | satara         | 2002-03-04    | lifetime        |       900 |                1 |          30.00 |
|         9 | pravin thakur   | Raigad         | 2024-06-07    | Annul           |      8900 |                5 |          70.00 |
+-----------+-----------------+----------------+---------

